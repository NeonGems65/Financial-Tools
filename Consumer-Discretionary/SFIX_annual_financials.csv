name,ttm,07/31/2023,07/31/2022,07/31/2021,07/31/2020,07/31/2019,07/31/2018,07/31/2017,07/31/2016
TotalRevenue,"1,428,559,000","1,638,423,000","2,072,812,000","2,101,258,000","1,711,733,000","1,577,558,000","1,226,505,000","977,139,000","730,313,000"
	OperatingRevenue,"1,428,559,000","1,638,423,000","2,072,812,000","2,101,258,000","1,711,733,000","1,577,558,000","1,226,505,000","977,139,000","730,313,000"
CostOfRevenue,"802,218,000","946,902,000","1,164,338,000","1,153,622,000","957,523,000","874,429,000","690,483,000","542,718,000","407,064,000"
GrossProfit,"626,341,000","691,521,000","908,474,000","947,636,000","754,210,000","703,129,000","536,022,000","434,421,000","323,249,000"
OperatingExpense,"763,339,000","869,318,000","1,116,519,000","1,010,997,000","805,874,000","679,634,000","492,998,000","402,781,000","259,021,000"
	SellingGeneralAndAdministration,"763,339,000","869,318,000","1,116,519,000","1,010,997,000","805,874,000","679,634,000","492,998,000","402,781,000","259,021,000"
OperatingIncome,"-136,998,000","-177,797,000","-208,045,000","-63,361,000","-51,664,000","23,495,000","43,024,000","31,640,000","64,228,000"
NetNonOperatingInterestIncomeExpense,"10,329,000","6,220,000","930,000","2,610,000","5,535,000","5,791,000","904,000","42,000",
	InterestIncomeNonOperating,"10,329,000","6,220,000","930,000","2,610,000","5,535,000","5,791,000","904,000","42,000",
	TotalOtherFinanceCost,,,,"-2,610,000","-5,535,000","-5,791,000",,,
OtherIncomeExpense,"3,117,000","1,094,000","-2,355,000","-366,000","-1,593,000","1,535,000","10,785,000","-18,881,000","-3,006,000"
	GainOnSaleOfSecurity,,,,,,,"10,685,000","-18,881,000","-3,019,000"
	OtherNonOperatingIncomeExpenses,"3,117,000","1,094,000","-2,355,000","-366,000","-1,593,000","1,535,000","100,000","42,000","13,000"
PretaxIncome,"-123,552,000","-170,483,000","-209,470,000","-61,117,000","-47,722,000","30,821,000","54,713,000","12,801,000","61,222,000"
TaxProvision,"1,548,000","1,490,000","-2,349,000","-52,241,000","19,395,000","-6,060,000","9,813,000","13,395,000","28,041,000"
NetIncomeCommonStockholders,"-121,001,000","-171,973,000","-207,121,000","-8,876,000","-67,117,000","36,863,000","35,541,000","-594,000","8,211,000"
	NetIncome,"-121,001,000","-171,973,000","-207,121,000","-8,876,000","-67,117,000","36,881,000","44,900,000","-594,000","33,181,000"
		NetIncomeIncludingNoncontrollingInterests,"-121,001,000","-171,973,000","-207,121,000","-8,876,000","-67,117,000","36,881,000","44,900,000","-594,000","33,181,000"
			NetIncomeContinuousOperations,"-125,100,000","-171,973,000","-207,121,000","-8,876,000","-67,117,000","36,881,000","44,900,000","-594,000","33,181,000"
	PreferredStockDividends,,,,,,,"768,000",,"2,533,000"
	OtherunderPreferredStockDividend,,,,"0","0","18,000","9,359,000","-18,632,000","22,437,000"
AverageDilutionEarnings,,,,"0","0","1,000","-8,256,000","0","1,285,000"
DilutedNIAvailtoComStockholders,"-121,001,000","-171,973,000","-207,121,000","-8,876,000","-67,117,000","36,864,000","27,285,000","-594,000","9,496,000"
BasicEPS,"-1.02","-1.5","-1.9","-0.08","-0.66","0.37","0.47","-0.006","0.096"
DilutedEPS,"-1.02","-1.5","-1.9","-0.08","-0.66","0.36","0.34","-0.006","0.096"
BasicAverageShares,"118,491,221","114,684,980","108,762,589","105,975,403","102,383,282","100,013,462","75,947,759","96,411,815","85,551,211"
DilutedAverageShares,"118,491,221","114,684,980","108,762,589","105,975,403","102,383,282","103,653,626","81,288,418","96,411,815","90,908,541"
TotalOperatingIncomeAsReported,"-136,998,000","-177,797,000","-208,045,000","-63,361,000","-51,664,000","23,495,000","43,024,000","31,640,000","64,228,000"
TotalExpenses,"1,565,557,000","1,816,220,000","2,280,857,000","2,164,619,000","1,763,397,000","1,554,063,000","1,183,481,000","945,499,000","666,085,000"
NetIncomeFromContinuingAndDiscontinuedOperation,"-121,001,000","-171,973,000","-207,121,000","-8,876,000","-67,117,000","36,881,000","44,900,000","-594,000","33,181,000"
NormalizedIncome,"-125,100,000","-171,973,000","-207,121,000","-8,876,000","-67,117,000","36,881,000","36,127,615","10,734,600","34,992,400"
InterestIncome,"10,329,000","6,220,000","930,000","2,610,000","5,535,000","5,791,000","904,000","42,000",
NetInterestIncome,"10,329,000","6,220,000","930,000","2,610,000","5,535,000","5,791,000","904,000","42,000",
EBIT,"-136,998,000","-177,797,000","-208,045,000","-63,361,000","-51,664,000","23,495,000","43,024,000","31,640,000","64,228,000"
EBITDA,"-88,568,000","-134,501,000","-170,860,000","-33,432,000","-29,047,000","37,826,000","53,566,000","39,295,000","67,772,000"
ReconciledCostOfRevenue,"802,218,000","946,902,000","1,164,338,000","1,153,622,000","957,523,000","874,429,000","690,483,000","542,718,000","407,064,000"
ReconciledDepreciation,"48,430,000","43,296,000","37,185,000","29,929,000","22,617,000","14,331,000","10,542,000","7,655,000","3,544,000"
NetIncomeFromContinuingOperationNetMinorityInterest,"-125,100,000","-171,973,000","-207,121,000","-8,876,000","-67,117,000","36,881,000","44,900,000","-594,000","33,181,000"
TotalUnusualItemsExcludingGoodwill,,,,,,,"10,685,000","-18,881,000","-3,019,000"
TotalUnusualItems,,,,,,,"10,685,000","-18,881,000","-3,019,000"
NormalizedEBITDA,"-88,568,000","-134,501,000","-170,860,000","-33,432,000","-29,047,000","37,826,000","42,881,000","58,176,000","70,791,000"
TaxRateForCalcs,"0.4","0.21","0.011","0.27","0.27","0.27","0.179","0.4","0.4"
TaxEffectOfUnusualItems,"0","0","0","0","0","0","1,912,615","-7,552,400","-1,207,600"